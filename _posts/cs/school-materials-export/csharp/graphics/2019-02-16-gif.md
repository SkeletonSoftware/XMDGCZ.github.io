---
layout: post
title: "GIF "
categories:
    - "csharp"
    - "graphics"
sort_index: 8
author: "David Malý"
--- 


## Použití GIF obrázků ve WPF aplikaci


Šimon Hrubý



    Při tvoření her nebo interaktivních aplikací se většinou používají pro reprezentaci různých charakterů statické obrázky.    Po použití pohyblivých obrázků se však celá aplikace oživí a působí zábavněji. Přitom na tom není nic těžkého.



Ukázka z WPF aplikace využívající animace ze hry World of Warcraft


![](images/jumpattack.gif)![](images/example.jpg)

### Instalace


    Jediný balíček, který je třeba pro použití GIF obrázků v aplikaci nainstalovat, je [WpfAnimatedGif](https://github.com/XamlAnimatedGif/WpfAnimatedGif)
To lze provést pohodlně ve Visual Studiu za pomocí Správce Nuget balíčků


### Přidání do šablony


Pro vložení gifu do šablony stačí vložit následující řádek a upravit cestu k obrázku v atributu *gif:ImageBehavior.AnimatedSource*.    
V návrhu se nebude zobrazovat, to až po spuštění aplikace. Pro účely návrhu lze nastavit klasický atribut *Source* pro zobrazení gifu ve statické podobě, ale není to nutné.


```

```



    V šabloně je ještě možné nastavit počet opakování atributem *gif:ImageBehavior.RepeatBehavior*.    
*0x* je defaultní nastavení, kdy se gif opakuje stále dokola. Pro opakování dvakrát za sebou by se nastavilo *2x*.


```

```

```


```

### Manipulace z kódu


    Za účelem střídání ruzných animací nebo jiné kontroly lze s gifem manipulovat ze zdrojových C# souborů v back-endu.



    Vytvoření gifu zobrazuje následující ukázka, do které se dosadí cesta v podobě *Uri*.    
    Je uchovávaný v proměnné *image* a následně se v 5. řádku vykreslí do šablony. Do prvního parametru se musí nastavit prvek typu *Image* s identifikátorem *x:Name*: "CharacterImage".


```
var image = new BitmapImage();
image.BeginInit();
image.UriSource = new Uri("pack://application:,,,/Resources/Character.gif");
image.EndInit();
ImageBehavior.SetAnimatedSource(CharacterImage, image);

```


    Tomuto gifu by se poté nastavil počet opakování následujícím způsobem:    
*(Do argumentu RepeatBehavior počet opakování číslem)*


```

ImageBehavior.SetRepeatBehavior(CharacterImage, new RepeatBehavior(1));

```

#### Akce po skončení gifu


Pokud máme například základní gif postoje, který by se měl stále opakovat a poté se přehraje animace útoku, po jejím konci by se měla animace vrátit zpět na postoj.


![](images/default.gif)![](images/attack1.gif)


    Takový event lze nastavit následujícím způsobem:    
*První argument je prvek obrázku, druhý handler*


```

ImageBehavior.AddAnimationCompletedHandler(CharacterImage, Handler);

```


Kdy handler je funkce s dvouma povinnými argumenty.


```

public void Handler(object sender, RoutedEventArgs e)
{
// Do something
}

```

### Závěr


    To by mělo pro základní použití stačit. Teď už nic nebrání tvorbě impozantních aplikací vyrážejících dech způsobující lásku na první pohled.    
Pro detailnější popis použití můžete navštívit oficiální dokumentaci: https://github.com/XamlAnimatedGif/WpfAnimatedGif/wiki, ale budu to brát jako urážku.

