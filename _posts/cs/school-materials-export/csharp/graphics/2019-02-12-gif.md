## Použití GIF obrázků ve WPF aplikaci

Šimon Hrubý

 Při tvoření her nebo interaktivních aplikací se většinou používají pro reprezentaci různých charakterů statické obrázky. Po použití pohyblivých obrázků se však celá aplikace oživí a působí zábavněji. Přitom na tom není nic těžkého. 

Ukázka z WPF aplikace využívající animace ze hry World of Warcraft

<div style="position: relative">
    ![](images/jumpattack.gif)
    ![](images/example.jpg)
</div>

### Instalace

 Jediný balíček, který je třeba pro použití GIF obrázků v aplikaci nainstalovat, je [WpfAnimatedGif](https://github.com/XamlAnimatedGif/WpfAnimatedGif)   
To lze provést pohodlně ve Visual Studiu za pomocí Správce Nuget balíčků 

### Přidání do šablony

Pro vložení gifu do šablony stačí vložit následující řádek a upravit cestu k obrázku v atributu *gif:ImageBehavior.AnimatedSource*.   
V návrhu se nebude zobrazovat, to až po spuštění aplikace. Pro účely návrhu lze nastavit klasický atribut *Source* pro zobrazení gifu ve statické podobě, ale není to nutné.

<code class="language-html"><Image
                gif:ImageBehavior.AnimatedSource="Images/animated.gif"
                Source="Images/animated.gif"/></code>

 V šabloně je ještě možné nastavit počet opakování atributem *gif:ImageBehavior.RepeatBehavior*.   
*0x* je defaultní nastavení, kdy se gif opakuje stále dokola. Pro opakování dvakrát za sebou by se nastavilo *2x*. 

<code class="language-html"><Image
                gif:ImageBehavior.AnimatedSource="Images/animated.gif"
                Source="Images/animated.gif"
                gif:ImageBehavior.RepeatBehavior="2x"/></code>

<code class="language-html"><Image gif:ImageBehavior.AnimatedSource="Images/animated.gif" /></code>

### Manipulace z kódu

 Za účelem střídání ruzných animací nebo jiné kontroly lze s gifem manipulovat ze zdrojových C# souborů v back-endu. 

 Vytvoření gifu zobrazuje následující ukázka, do které se dosadí cesta v podobě *Uri*.   
 Je uchovávaný v proměnné *image* a následně se v 5. řádku vykreslí do šablony. Do prvního parametru se musí nastavit prvek typu *Image* s identifikátorem *x:Name*: "CharacterImage". 

<code class="language-C#">var image = new BitmapImage();
    image.BeginInit();
    image.UriSource = new Uri("pack://application:,,,/Resources/Character.gif");
    image.EndInit();
    ImageBehavior.SetAnimatedSource(CharacterImage, image);</code>

 Tomuto gifu by se poté nastavil počet opakování následujícím způsobem:   
*(Do argumentu RepeatBehavior počet opakování číslem)* 

    <code class="language-C#">ImageBehavior.SetRepeatBehavior(CharacterImage, new RepeatBehavior(1));</code>

#### Akce po skončení gifu

Pokud máme například základní gif postoje, který by se měl stále opakovat a poté se přehraje animace útoku, po jejím konci by se měla animace vrátit zpět na postoj.

<div style="position: relative; overflow: hidden; margin-top: -50px">
    ![](images/default.gif)
    ![](images/attack1.gif)
</div>

 Takový event lze nastavit následujícím způsobem:   
*První argument je prvek obrázku, druhý handler* 

    <code class="language-C#">ImageBehavior.AddAnimationCompletedHandler(CharacterImage, Handler);</code>

Kdy handler je funkce s dvouma povinnými argumenty.

    <code class="language-C#">public void Handler(object sender, RoutedEventArgs e)
    {
    // Do something
    }</code>

### Závěr

 To by mělo pro základní použití stačit. Teď už nic nebrání tvorbě impozantních aplikací vyrážejících dech způsobující lásku na první pohled.   
Pro detailnější popis použití můžete navštívit oficiální dokumentaci: [https://github.com/XamlAnimatedGif/WpfAnimatedGif/wiki](https://github.com/XamlAnimatedGif/WpfAnimatedGif/wiki), ale budu to brát jako urážku. 