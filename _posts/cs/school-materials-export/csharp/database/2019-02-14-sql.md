---
layout: post
title: "SQL "
categories:
    -"csharp"
    -"database"
author: "David Malý"
--- 


## SQL


<br>    V databázi je uloženo velké množství dat, která je potřeba automatizovaně zpracovávat. K ulehčení práce s relačními databázemi vznikl dotazovací strukturovaný jazyk SQL.<br>

[Procvičení SQL](https://sqlbolt.com/)
### Historie

- <br>        Vznik v 70. letech spolu s vývojem relační databáze u IBM jakožto jazyk SEQUEL, dotazy jsou psány co nejblíže angličtině<br>
- <br>        Standartizován institutem ANSI jako SQL-86 (rok vydání), další standarty SQL-92 (SQL2) a dnešní SQL-99 (SQL3)<br>
- <br>        Většina databází obsahuje jen část prvků z norem. Přenositelnost SQL dotazů mezi různými DB používající SQL je tedy omezená<br>


### Datové typy


<br>    Každý sloupec v SQL databázi má přidělený datový typ, ten určuje jakou část paměti pro daný sloupec použijeme a tedy i jak velkou hodnotu můžeme do pole uložit.<br>


- <br>        int - Celočíselné hodnoty<br>
- <br>        varchar - Znaky<br>
- <br>        text - Znaky s dynamickou délkou<br>
- <br>        bit - Bolean<br>


### Klíče (Indexy)


<br>    SQL jazyk využívá škálu indexů, což jsou databázové konstrukce, které slouží ke zrychlení vyhledávání a dotazování v databázi. Při správném použití indexování lze vidět značné zrychlení databáze jako celku.<br>



<br>    Příliš mnoho nerozvážných indexů přináší opačný dopad a výsledek může ztrácet na efektivitě.<br>



<br>    Rozlišujeme několik základních indexů:<br>


- <br>        Primární - (PRIMARY)<br>
- <br>        Unikátní - (UNIQUE)<br>
- <br>        Sekundární - (INDEX)<br>
- <br>        Fulltextové - (FULLTEXT)<br>
- <br>        Kandidátní - (CANDIDATE KEY)<br>
- <br>        Cizí - (FOREIGN KEY)<br>


#### Primární klíč


<br>    Primární klíč je pro každý záznam unikátní a jednoznačně definován sloupcem, či více sloupci. Ze zvyklosti, je vžitá konvence nazývat tento sloupec ID a používat celočíselný datový typ (SMALLINT, INT).<br>


#### Kandidátní klíč


<br>    Jedná se o indexy, které splňují stejné podmínky jako primární klíč. Jsou to tedy unikátní hodnoty, dle kterých se dají záznamy jednoznačně indentifikovat.<br>


#### Cizí klíč


<br>    Cizí klíč definuje vztah mezi dvěmy tabulkami, a to tak, že hodnota ve sloupci odkazuje na jinou (primární) tabulku, která v ní musí existovat. Tomuto spojení se též říká reference nebo odkaz.<br>



<br>    Na cizí klíč lze nastavit handlery, které se spustí při úpravě/smazání hodnoty, na kterou odkazují.<br>


### SQL příkazy


<br>    SQL příkazy lze dělit na pět základních skupin:<br>


1. <br>        Příkazy pracující s daty  (SELECT, INSERT, UPDATE, DELETE, ...)<br>
2. <br>        Příkazy pro definici prostředí (CREATE, ALTER, DROP, ...)<br>
3. <br>        Příkazy pro řízení přístupových práv (GRANT, REVOKE)<br>
4. <br>        Příkazy pro řízení transakcí (START TRANSACTION, COMMIT, ROLLBACK)<br>
5. <br>        Ostatní a speciální příkazy<br>


#### Příklady příkazů

##### SELECT


<br>    Slouží k výpisu dat z databáze podle určitých kritérií.<br>


```

Syntax  SELECT `table`.`row` FROM `table`;
SELECT * FROM `table`;

```


<br>    Další nepovinné sektory příkazu<br>


- <br>        WHERE - Vybere pouze výsledky odpovídající následující podmínce<br>
- <br>        JOIN - Spojí dotaz s jinou tabulkou a prováže je danými sloupci<br>
- <br>            GROUP BY - Sloučí stejné výsledky dle daného sloupce<br>
- <br>            ORDER BY - Seřadí dle sloupců<br>
- <br>            LIMIT - Vybere výsledky od daného pořadí, druhé číslo určuje počet řádků.<br>



<br>    Příklady příkazů<br>


```

SELECT * FROM `table` WHERE `id` = 3;
SELECT `id` FROM `table` WHERE `name` LIKE 'admin';
SELECT * FROM `table` WHERE `psw` = '4ccfef82'
SELECT * FROM `table` WHERE `lastActive` < 1406547898 ORDER BY `id` ASC;
SELECT * FROM `table` WHERE 50, 100;
SELECT * FROM `table` AS `u` JOIN `userInfo` AS `ui` ON `u`.`id`=`ui`.`id`;
SELECT COUNT(*) FROM `table` WHERE `agree` = 1;
SELECT `table`, COUNT(`money`) FROM `transactions`;

```

##### Insert


<br>    Slouží k zápisu dat do databáze.<br>


```

INSERT INTO `table` (`row`,`row2`) VALUES (12, 'val'), ( 15, 'val');

```

##### Update


<br>    Slouží k přepisu dat v databázi.<br>


```


UPDATE `table` SET `row` = 'aa';
UPDATE `table` SET `row` = `rowOld`;
UPDATE `table` SET `row` = `rowOld` + 1;

```

##### Delete


<br>    Slouží k mazání dat z databáze.<br>


```

DELETE FROM `table`;
DELETE FROM `table` WHERE `accept` = 0 LIMIT 50;

```
