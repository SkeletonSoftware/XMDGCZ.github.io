---
layout: post
title: "SQL "
categories:
    - "csharp"
    - "database"
sort_index: 2
author: "David Malý"
--- 


## SQL


    V databázi je uloženo velké množství dat, která je potřeba automatizovaně zpracovávat. K ulehčení práce s relačními databázemi vznikl dotazovací strukturovaný jazyk SQL.

[Procvičení SQL](https://sqlbolt.com/)
### Historie

-         Vznik v 70. letech spolu s vývojem relační databáze u IBM jakožto jazyk SEQUEL, dotazy jsou psány co nejblíže angličtině
-         Standartizován institutem ANSI jako SQL-86 (rok vydání), další standarty SQL-92 (SQL2) a dnešní SQL-99 (SQL3)
-         Většina databází obsahuje jen část prvků z norem. Přenositelnost SQL dotazů mezi různými DB používající SQL je tedy omezená


### Datové typy


    Každý sloupec v SQL databázi má přidělený datový typ, ten určuje jakou část paměti pro daný sloupec použijeme a tedy i jak velkou hodnotu můžeme do pole uložit.


-         int - Celočíselné hodnoty
-         varchar - Znaky
-         text - Znaky s dynamickou délkou
-         bit - Bolean


### Klíče (Indexy)


    SQL jazyk využívá škálu indexů, což jsou databázové konstrukce, které slouží ke zrychlení vyhledávání a dotazování v databázi. Při správném použití indexování lze vidět značné zrychlení databáze jako celku.



    Příliš mnoho nerozvážných indexů přináší opačný dopad a výsledek může ztrácet na efektivitě.



    Rozlišujeme několik základních indexů:


-         Primární - (PRIMARY)
-         Unikátní - (UNIQUE)
-         Sekundární - (INDEX)
-         Fulltextové - (FULLTEXT)
-         Kandidátní - (CANDIDATE KEY)
-         Cizí - (FOREIGN KEY)


#### Primární klíč


    Primární klíč je pro každý záznam unikátní a jednoznačně definován sloupcem, či více sloupci. Ze zvyklosti, je vžitá konvence nazývat tento sloupec ID a používat celočíselný datový typ (SMALLINT, INT).


#### Kandidátní klíč


    Jedná se o indexy, které splňují stejné podmínky jako primární klíč. Jsou to tedy unikátní hodnoty, dle kterých se dají záznamy jednoznačně indentifikovat.


#### Cizí klíč


    Cizí klíč definuje vztah mezi dvěmy tabulkami, a to tak, že hodnota ve sloupci odkazuje na jinou (primární) tabulku, která v ní musí existovat. Tomuto spojení se též říká reference nebo odkaz.



    Na cizí klíč lze nastavit handlery, které se spustí při úpravě/smazání hodnoty, na kterou odkazují.


### SQL příkazy


    SQL příkazy lze dělit na pět základních skupin:


1.         Příkazy pracující s daty  (SELECT, INSERT, UPDATE, DELETE, ...)
2.         Příkazy pro definici prostředí (CREATE, ALTER, DROP, ...)
3.         Příkazy pro řízení přístupových práv (GRANT, REVOKE)
4.         Příkazy pro řízení transakcí (START TRANSACTION, COMMIT, ROLLBACK)
5.         Ostatní a speciální příkazy


#### Příklady příkazů

##### SELECT


    Slouží k výpisu dat z databáze podle určitých kritérií.


```

Syntax  SELECT `table`.`row` FROM `table`;
SELECT * FROM `table`;

```


    Další nepovinné sektory příkazu


-         WHERE - Vybere pouze výsledky odpovídající následující podmínce
-         JOIN - Spojí dotaz s jinou tabulkou a prováže je danými sloupci
-             GROUP BY - Sloučí stejné výsledky dle daného sloupce
-             ORDER BY - Seřadí dle sloupců
-             LIMIT - Vybere výsledky od daného pořadí, druhé číslo určuje počet řádků.



    Příklady příkazů


```

SELECT * FROM `table` WHERE `id` = 3;
SELECT `id` FROM `table` WHERE `name` LIKE 'admin';
SELECT * FROM `table` WHERE `psw` = '4ccfef82'
SELECT * FROM `table` WHERE `lastActive` < 1406547898 ORDER BY `id` ASC;
SELECT * FROM `table` WHERE 50, 100;
SELECT * FROM `table` AS `u` JOIN `userInfo` AS `ui` ON `u`.`id`=`ui`.`id`;
SELECT COUNT(*) FROM `table` WHERE `agree` = 1;
SELECT `table`, COUNT(`money`) FROM `transactions`;

```

##### Insert


    Slouží k zápisu dat do databáze.


```

INSERT INTO `table` (`row`,`row2`) VALUES (12, 'val'), ( 15, 'val');

```

##### Update


    Slouží k přepisu dat v databázi.


```


UPDATE `table` SET `row` = 'aa';
UPDATE `table` SET `row` = `rowOld`;
UPDATE `table` SET `row` = `rowOld` + 1;

```

##### Delete


    Slouží k mazání dat z databáze.


```

DELETE FROM `table`;
DELETE FROM `table` WHERE `accept` = 0 LIMIT 50;

```
