---
layout: post
title: "Observer "
categories:
    -"csharp"
    -"modelsSingle"
author: "David Malý"
--- 


##   Observer design pattern


Jakub Staněk



Tento návrhový vzor definuje závislost mezi jedním a více objekty (one-to-many), takže když jeden objekt změní stav, všechny objekty závislé na něm bude automaticky upozorněny a aktuaizovány.



**Pozorovatel - observer**



**Vydavatel(pozorovaný) - subject**



![observer pattern UML diagram](images/observerClassDiagram.png)



Pozn.<br>    *Obrázek je použit ze stránky [dotnettricks.com](http://www.dotnettricks.com/learn/designpatterns/observer-design-pattern-c-sharp)*


### Třídy a objektu vzoru

#### <br>    Subject<br>


Zná svůj observer (pozorovatele)



Jakýkoli počet objektů pozorovatele může sledovat předmět



poskytuje rozhraní pro připojení a odpojení objektů pozorovatele


#### <br>    ConcreteSubject(konkrétní předmět)<br>


Konkrétní předmět, který obsahuje sbírku pozorovatelů, jak je vidět na obrázku výše



Uchovává stav konkrétního observer(pozorovatele)



Poskytuje rozhraní pro připojení a odpojení objektů pozorovatele


#### <br>    Observer(pozorovatel)<br>


Definuje různé rozhraní pro aktualizace jednotlivých objektů, které by měly být informovány o změnách v objektu



Jakýkoli počet objektů pozorovatele může sledovat předmět


#### <br>    ConcreteObserver(konkrétní pozorovatel)<br><br>


Odkazuje na objekt konkrétního předmětu



Uchovává stav, který by měl být zůstat v logickém souladu s předmětem



Implementuje rozhraní pro aktualizaci Observeru (pozorovatele), aby udrželo stav konkrétního předmětu


### Názorná ukázka na obrázku z praxe


Pozn.<br>    *Obrázek a informace jsou použity ze stránky [dotnettricks.com](http://www.dotnettricks.com/learn/designpatterns/observer-design-pattern-c-sharp)*



<br>    Některé dražby demonstrují tento vzor. Každý uchazeč má očíslované pádlo, které se používá k označení nabídky.<br>



<br>    Dražebník zahájí nabízení a "pozoruje", když je pádlo zvednuto, aby nabídku přijalo. Přijímáním nabídky se změní nabídková cena,<br>    která se vysílá všem uchazečům formou nové nabídky.<br>


#### Další vysvětlení použítí návrhového vzoru v praxi


<br>    Máte konkrétní příklad Studenta a MessageBoard. Student se zaregistruje přidáním do seznamu pozorovatelů, kteří chtějí být upozorněni, když je na MessageBoard zaslána nová zpráva.<br>



<br>    Když je do zprávy MessageBoard přidána zpráva, opakuje se nad seznamem pozorovatelů a upozorní je, že událost nastala.<br>



<br>    Přemýšlejte o Twitteru. Když říkáte, že chcete sledovat někoho, Twitter vás přidá do svého seznamu následovníků. Když vám poslali nový tweet, vidíš to na svém vstupu. V takovém případě je váš účet Twitter sledovatelem a osoba, kterou sledujete, je pozorovatelna.<br>



![Observer v praxi](images/observerAuction.png)


### Ukázka implementace Observeru v C#


Pozn.<br>    *ukázka je použíta ze stránky [sourcemaking.com](https://sourcemaking.com/design_patterns/facade)*


```

public abstract class Subject
{
 private ArrayList observers = new ArrayList();

 public void Attach(IObserver o)
 {
 observers.Add(o);
 }

 public void Detach(IObserver o)
 {
 observers.Remove(o);
 }

 public void Notify()
 {
 foreach (IObserver o in observers)
 {
 o.Update();
 }
 }
}

public class ConcreteSubject : Subject
{
 private string state;

 public string GetState()
 {
 return state;
 }

 public void SetState(string newState)
 {
 state = newState;
 Notify();
 }
}

public interface IObserver
{
 void Update();
}

public class ConcreteObserver : IObserver
{
 private ConcreteSubject subject;

 public ConcreteObserver(ConcreteSubject sub)
 {
 subject = sub;
 }

 public void Update()
 {
 string subjectState = subject.GetState();
 Console.WriteLine(subjectState);
 }
}


```

#### Shrnutí


Observer je velmi dobré využítí v praxi, jelikož "spravuje" objekty pod ním - notifikuje a aktualizuje. Vytváří přehlednost v kódu a také logicky upravuje kód.


#### Zdroje
[dotnettricks](http://www.dotnettricks.com/learn/designpatterns/observer-design-pattern-c-sharp)[dofactory](http://www.dofactory.com/net/observer-design-pattern)[codeproject](https://www.codeproject.com/Tips/769084/Observer-Pattern-Csharp)[sourcemaking](https://sourcemaking.com/design_patterns/observer)